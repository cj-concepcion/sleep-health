[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Geographic Sleep Health Disparities in New York City",
    "section": "",
    "text": "1 Introduction\nGetting good sleep is a basic and essential human need, but the reality is that good sleep is a privilege in it of itself. The conditions in different neighborhoods create major disparities in sleep quality and health, and these differences are often seen along racial and economic lines. Areas with less resources face all sorts of environmental factors that interfere with the ability/opportunity to get good sleep - constant noise from traffic (i.e., sirens from ambulance or police activity), bright lights at night, and air pollution. Over time, these various factors can accumulate and possibly create long-term sleep problems. A lot of work in the social health field has found clear connections between sleep, race, and income that points to bigger systemic problems. Neighborhoods that have historically gotten the short end of the stick still face neglect today, with living conditions that make good sleep tough to come by. The stress of working multiple jobs or dealing with long commutes only makes things worse. Poor sleep leads to higher risks of heart disease, diabetes, and mental health problems - health issues that already hit communities of color and lower-income areas harder, creating a vicious cycle where bad neighborhood conditions hurt sleep, poor sleep hurts health, and poor health strains entire communities. (Meldrum et al., 2018; Kim et al, 2022; Hunter & Hayden, 2018\nFor this project, I wanted to investigate potential associations between race, socioeconomic status and sleep health within the context of New York City (NYC). NYC makes for a particularly interesting place to look at these sleep differences because of its sheer density and simultaneous racial and socioeconomic diversity. In this packed city, the quality of neighborhoods can change drastically within just a few blocks, and with some of the biggest wealth gaps in the country - where fancy high-rises stand right next to struggling neighborhoods - NYC may show particularly stark contrasts of how neighborhood conditions and economic inequalities affect people’s ability to get good sleep.\nI am also interested in looking at these data over time since there have been some major societal-level events that have disproportionately impacted NYC that created unique contexts through which these sleep health differences may have even been further exacerbated, such as the COVID-19 pandemic and the Black Lives Matter movement.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Description\nPopulation Demographics: Race and Socioeconomic Data These data are available on the U.S. Census Bureau website, they just have to properly be queried at the zipcode tabulation area (ZCTA) level which ended up being more time consuming than initially planned because I could not find a way to get it at the ZCTA level without having to manually select/filter all the ZCTAs that fall within NYC. If you try to filter by county for instance, it will only give you the population demographics aggregated at the county level vs. ZCTA, which would not match our unit of analysis. This will be sorted soon! The good thing is there is a clear concrete plan and the data is there in a unit similar to to the sleep data (percentage or prevalence per ZCTA).\nSleep Data Over Time Sleep data are obtained from the CDC’s PLACES Local Data for Better Health datasets directly from the CDC website (Center for Disease Control and Prevention, 2020, 2023, 2024). The PLACES datasets are created with ZCTA-level estimates derived from data collected through the nationally representative annual U.S. Behavioral Risk Factor Surveillance Survey (BRFSS). The BRFSS is an annual, phone-based survey of the US population who are 18 years and older. The CDC works with local state health department to interview respondents. Every other year, the BRFSS includes a question asking “On average, how many hours of sleep do you get in a 24-hour period?”.\nUsing the BRFSS data, an estimate is created for the percentage of the population (per ZCTA) that reports sleeping &lt; 7 hours on average. Population data used to help model these estimates were drawn from the American Community Surveys (ACS) for each of the respective BRFSS years (2018, 2020, 2022). The ACS is collected and managed by the U.S. Census Bureau. Because sleep data is only collected every other year and PLACES short sleep prevalence estimates are created using the most recent year with available data (even if the year the data were collected does not align with the release year of the PLACES dataset) I plan to use the PLACES datasets for the years 2020, 2023, 2024 which created estimates for sleep using BRFSS data from 2018, 2020, and 2022. respectively (Center for Disease Control and Prevention, 2020, 2023 & 2024).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis\nBecause each row of the sleep data is a model estimated value, there actually aren’t any NAs in this dataset, however once I merge the Bureau demographic data, I anticipate NAs will be introduced simply by mismatched or unmatched ZTCAs.\nMy plan for the final project is that once these datsets are properly merged, I will do a proper pivot longer and create a “missing” data column and do a geom_tile plot to visualize the missing data. I am thinking to do 1 missing data plot per year so as to not overcrowd the visual.\n\n2.2.1 Missing Value Plot\n\n\nCode\n# Load required libraries\nlibrary(tidyverse)\nlibrary(reshape2)\n\n# Read the data\ndf &lt;- read.csv(\"data_cleaning/sleep_health_final_dataset.csv\")\n\n# Create missing value matrix\nmissing_matrix &lt;- is.na(df) |&gt; \n  as.data.frame() |&gt;\n  mutate(row_id = row_number()) |&gt;\n  melt(id.vars = \"row_id\", variable.name = \"column\", value.name = \"is_missing\")\n\n# Create the heatmap\nggplot(missing_matrix, aes(x = column, y = row_id, fill = is_missing)) +\n  geom_tile() +\n  scale_fill_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"salmon\")) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(title = \"Missing Values Heatmap\",\n       x = \"Variables\",\n       y = \"Row Number\",\n       fill = \"Is Missing\") +\n  coord_flip()",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#zero-value-analysis",
    "href": "data.html#zero-value-analysis",
    "title": "2  Data",
    "section": "2.3 Zero Value Analysis",
    "text": "2.3 Zero Value Analysis\n\n\nCode\n# Calculate percentage of zeros for all numeric columns\nzero_summary &lt;- sapply(df, function(x) if(is.numeric(x)) mean(x == 0) * \n                         100 else NA) |&gt;\n  as.data.frame() |&gt;\n  setNames(\"zero_percentage\") |&gt;\n  rownames_to_column(\"variable\") |&gt;\n  filter(!is.na(zero_percentage), zero_percentage &gt; 0) |&gt;\n  arrange(desc(zero_percentage))\n\n# Create a bar plot\nggplot(zero_summary, aes(x = reorder(variable, zero_percentage), \n                         y = zero_percentage)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f%%\", zero_percentage)), \n            hjust = -0.1, \n            size = 3.5) +\n  coord_flip() +\n  theme_minimal() +\n  labs(title = \"Percentage of Zero Values by Column\",\n       x = \"Variables\",\n       y = \"Percentage of Zeros (%)\") +\n  theme(\n    plot.title = element_text(size = 14, face = \"bold\"),\n    axis.text = element_text(size = 10),\n    panel.grid.major.y = element_blank()\n  ) +\n  scale_y_continuous(limits = c(0, max(zero_summary$zero_percentage) * 1.2))\n\n\n\n\n\n\n\n\n\n\nWrite about systematic 0 values, race makes sense in areas of less diversity, income makes sense since they are gradiated steps / cumulative / may be mutually exclusive in that way\nPOSSIBLE BONUS IF THERES TIME - look deeper into systemic SES patterns for ZCTAs with multiple 0’s\n\n\n\nCode\n# Create a better visualization of the zero patterns\nzero_locations &lt;- df |&gt;\n  select(zcta5, edu_gr9, inc_15k, inc_25k) |&gt;\n  filter(edu_gr9 == 0 | inc_15k == 0 | inc_25k == 0)\n\n# Convert data to long format for better visualization\nzero_long &lt;- zero_locations |&gt;\n  pivot_longer(cols = c(edu_gr9, inc_15k, inc_25k),\n               names_to = \"variable\",\n               values_to = \"value\") |&gt;\n  mutate(is_zero = value == 0)\n\n# Create a more readable visualization\nggplot(zero_long, aes(x = factor(zcta5), y = variable, fill = is_zero)) +\n  geom_tile(color = \"white\") +\n  scale_fill_manual(values = c(\"steelblue\", \"coral\")) +\n  theme_minimal() +\n  labs(title = \"Zero Values Pattern Across ZCTAs\",\n       x = \"ZCTA\",\n       y = \"Variable\",\n       fill = \"Is Zero\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid = element_blank()) +\n  scale_x_discrete(name = \"ZCTA\")\n\n\n\n\n\n\n\n\n\nCode\n# Create a summary table of the patterns\nzero_summary &lt;- zero_long |&gt;\n  group_by(zcta5) |&gt;\n  summarise(\n    num_zeros = sum(is_zero),\n    variables_with_zeros = paste(variable[is_zero], collapse = \", \")\n  )\n\nzero_summary\n\n\n\n\n\n\nzcta5\nnum_zeros\nvariables_with_zeros\n\n\n\n\n10004\n1\ninc_15k\n\n\n10006\n2\nedu_gr9, inc_15k\n\n\n10007\n1\ninc_25k\n\n\n10069\n1\nedu_gr9\n\n\n10282\n1\ninc_25k\n\n\n10464\n1\ninc_15k\n\n\n11109\n3\nedu_gr9, inc_15k, inc_25k",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "3.1 Sleep Trends Over Time (2018-2022)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#sleep-trends-over-time-2018-2022",
    "href": "results.html#sleep-trends-over-time-2018-2022",
    "title": "3  Results",
    "section": "",
    "text": "3.1.1 Average Overall Trend Over Time - GRAPH 1 MEDIOCRE\n\n\nCode\n# Load required libraries\nlibrary(tidyverse)\nlibrary(scales)\nlibrary(ggplot2)\n\n# Reshape the data for easier plotting\nsleep_data &lt;- read.csv(\"data_cleaning/sleep_health_final_dataset.csv\") |&gt;\n  summarise(\n    sleep18_2018 = mean(perc_sleep18),\n    sleep18_2020 = mean(perc_sleep20),\n    sleep18_2022 = mean(perc_sleep22)\n  ) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"measure\",\n    values_to = \"percentage\"\n  ) |&gt;\n  mutate(\n    year = case_when(\n      str_detect(measure, \"2018\") ~ 2018,\n      str_detect(measure, \"2020\") ~ 2020,\n      str_detect(measure, \"2022\") ~ 2022\n    ),\n    age_group = str_extract(measure, \"\\\\d+\") |&gt; \n      paste0(\"Age \", str_extract(measure, \"\\\\d+\"), \"+\") # paste0(\"Age \", _, \"+\") # or we could just do: paste0(\"Age \", str_extract(measure, \"\\\\d+\"), \"+\")\n  )\n\n# Create the plot\nsleep_trends_plot &lt;- ggplot(sleep_data, aes(x = year, y = percentage, group = 1)) +\n  geom_line(linewidth = 1, color = \"#2c3e50\") +\n  geom_point(size = 3, color = \"#2c3e50\") +\n  scale_y_continuous(\n    limits = c(30, 45),\n    labels = function(x) paste0(x, \"%\"),\n    breaks = seq(30, 45, by = 5)\n  ) +\n  scale_x_continuous(breaks = c(2018, 2020, 2022)) +\n  labs(\n    title = \"Sleep Deprivation Trends in NYC (2018-2022)\",\n    subtitle = \"Percentage of adults sleeping less than 7 hours per night\",\n    x = \"Year\",\n    y = \"Percentage of Population\",\n    caption = \"Data source: NYC Health Department\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(color = \"gray30\"),\n    axis.title = element_text(face = \"bold\"),\n    panel.grid.minor = element_blank(),\n    plot.caption = element_text(color = \"gray30\", hjust = 0)\n  )\n\n# Display the plot\nprint(sleep_trends_plot)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#sleep-trends-by-neighborhood---graph-2a",
    "href": "results.html#sleep-trends-by-neighborhood---graph-2a",
    "title": "3  Results",
    "section": "3.2 Sleep Trends by Neighborhood - GRAPH 2A",
    "text": "3.2 Sleep Trends by Neighborhood - GRAPH 2A\n\n\nCode\nlibrary(sf)\nlibrary(viridis) \nsleep_health_data_geo &lt;- st_read(\"data/sleep_health_geo_dataset.shp\", quiet =\n                                   TRUE)\n\n# Basic choropleth of 2022 sleep deprivation rates\nggplot() +\n  geom_sf(data = sleep_health_data_geo,\n          aes(fill = prc_s22),\n          color = \"white\",\n          size = 0.1) +\n  scale_fill_viridis(\n    option = \"magma\",\n    name = \"% Adults\\nSleeping &lt;7hrs\",\n    limits = c(25, 50),\n    direction = -1  # Added this line to flip the scale\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Sleep Deprivation Rates Across NYC Zip Code Areas (2022)\",\n    subtitle = \"Percentage of adults reporting less than 7 hours of sleep per night\",\n    caption = \"Data source: CDC\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(color = \"gray30\"),\n    legend.position = \"right\",\n    panel.grid = element_blank(),\n    axis.text = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n3.2.1 Neighborhood Sleep Trends Over Time - GRAPH 2B\n\n\nCode\n# Faceted version showing change over time\nsleep_health_data_geo_long &lt;- sleep_health_data_geo |&gt;\n  pivot_longer(\n    cols = c(prc_s18, prc_s20, prc_s22),\n    names_to = \"year\",\n    values_to = \"sleep_perc\"\n  ) |&gt;\n  mutate(year = case_when(\n    year == \"prc_s18\" ~ \"2018\",\n    year == \"prc_s20\" ~ \"2020\",\n    year == \"prc_s22\" ~ \"2022\"\n  ))\n\nggplot() +\n  geom_sf(data = sleep_health_data_geo_long,\n          aes(fill = sleep_perc),\n          color = \"white\",\n          size = 0.1) +\n  scale_fill_viridis(\n    option = \"magma\",\n    name = \"% Adults\\nSleeping &lt;7hrs\",\n    limits = c(25, 50),\n    direction = -1  # Added this line to flip the scale\n  ) +\n  facet_wrap(~year) +\n  theme_minimal() +\n  labs(\n    title = \"Changes in Sleep Deprivation Across NYC (2018-2022)\",\n    subtitle = \"Percentage of adults reporting less than 7 hours of sleep per night\",\n    caption = \"Data source: CDC\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(color = \"gray30\"),\n    legend.position = \"right\",\n    panel.grid = element_blank(),\n    axis.text = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n3.2.2 Zooming in further.. which neighborhoods experienced the greatest changes in sleep deprivation patterns between 2018, 2020 and 2022? GRAPH 3 & 4\n\n\nCode\n# Load and prepare the data\ndf &lt;- read.csv(\"data/sleep_health_final_dataset.csv\")\n\n# Calculate mean sleep deprivation by neighborhood for each year\nneighborhood_sleep &lt;- aggregate(\n    cbind(perc_sleep18, perc_sleep20, perc_sleep22) ~ neighborhood, \n    data = df, \n    FUN = mean\n)\n\n# Calculate changes\nneighborhood_sleep$change_18_20 &lt;- neighborhood_sleep$perc_sleep20 - neighborhood_sleep$perc_sleep18\nneighborhood_sleep$change_20_22 &lt;- neighborhood_sleep$perc_sleep22 - neighborhood_sleep$perc_sleep20\n\n# Get top 10 decreases for 2018-2020\ntop_10_decrease &lt;- neighborhood_sleep[order(neighborhood_sleep$change_18_20), ][1:10, ]\ntop_10_decrease$neighborhood &lt;- factor(top_10_decrease$neighborhood, \n                                     levels = rev(top_10_decrease$neighborhood))\n\n# Get top 10 increases for 2020-2022\ntop_10_increase &lt;- neighborhood_sleep[order(-neighborhood_sleep$change_20_22), ][1:10, ]\ntop_10_increase$neighborhood &lt;- factor(top_10_increase$neighborhood, \n                                     levels = rev(top_10_increase$neighborhood))\n\n# Define muted colors\ncolor_2018 &lt;- \"#7294d4\"  # muted blue\ncolor_2020 &lt;- \"#d4827e\"  # muted red\ncolor_2022 &lt;- \"#82b37d\"  # muted green\n\n# Create first Cleveland dot plot (2018-2020 top 10 decreases)\np1 &lt;- ggplot(top_10_decrease, aes(y = neighborhood)) +\n    geom_segment(aes(x = perc_sleep18, xend = perc_sleep20, \n                    yend = neighborhood), \n                color = \"#cccccc\", size = 0.8) +\n    geom_point(aes(x = perc_sleep18), color = color_2018, size = 4, alpha = 0.8) +\n    geom_point(aes(x = perc_sleep20), color = color_2020, size = 4, alpha = 0.8) +\n    theme_minimal() +\n    labs(\n        title = \"Top 10 Largest Decreases in Sleep Deprivation (2018 to 2020)\",\n        subtitle = \"Percentage of population reporting insufficient sleep\",\n        x = \"Percent Sleep Deprived\",\n        y = NULL\n    ) +\n    theme(\n        panel.grid.major.y = element_blank(),\n        panel.grid.minor = element_blank(),\n        axis.text.y = element_text(size = 10, color = \"black\"),\n        axis.text.x = element_text(size = 10, color = \"black\"),\n        plot.title = element_text(size = 12, face = \"bold\"),\n        plot.subtitle = element_text(size = 10, color = \"grey40\"),\n        plot.margin = margin(20, 20, 20, 20)\n    ) +\n    annotate(\"text\", x = max(top_10_decrease$perc_sleep20) + 1, \n             y = 10, \n             label = \"2020\", color = color_2020, hjust = 0, size = 4) +\n    annotate(\"text\", x = min(top_10_decrease$perc_sleep18) - 1, \n             y = 10, \n             label = \"2018\", color = color_2018, hjust = 1, size = 4)\n\n# Create second Cleveland dot plot (2020-2022 top 10 increases)\np2 &lt;- ggplot(top_10_increase, aes(y = neighborhood)) +\n    geom_segment(aes(x = perc_sleep20, xend = perc_sleep22, \n                    yend = neighborhood), \n                color = \"#cccccc\", size = 0.8) +\n    geom_point(aes(x = perc_sleep20), color = color_2020, size = 4, alpha = 0.8) +\n    geom_point(aes(x = perc_sleep22), color = color_2022, size = 4, alpha = 0.8) +\n    theme_minimal() +\n    labs(\n        title = \"Top 10 Largest Increases in Sleep Deprivation (2020 to 2022)\",\n        subtitle = \"Percentage of population reporting insufficient sleep\",\n        x = \"Percent Sleep Deprived\",\n        y = NULL\n    ) +\n    theme(\n        panel.grid.major.y = element_blank(),\n        panel.grid.minor = element_blank(),\n        axis.text.y = element_text(size = 10, color = \"black\"),\n        axis.text.x = element_text(size = 10, color = \"black\"),\n        plot.title = element_text(size = 12, face = \"bold\"),\n        plot.subtitle = element_text(size = 10, color = \"grey40\"),\n        plot.margin = margin(20, 20, 20, 20)\n    ) +\n    annotate(\"text\", x = max(top_10_increase$perc_sleep22) + 1, \n             y = 10, \n             label = \"2022\", color = color_2022, hjust = 0, size = 4) +\n    annotate(\"text\", x = min(top_10_increase$perc_sleep20) - 1, \n             y = 10, \n             label = \"2020\", color = color_2020, hjust = 1, size = 4)\n\n# Print both plots\nprint(p1)\n\n\n\n\n\n\n\n\n\nCode\nprint(p2)\n\n\n\n\n\n\n\n\n\nCode\n# Print summary statistics for top 10 changes\nprint(\"Top 10 largest decreases 2018-2020:\")\n\n\n[1] \"Top 10 largest decreases 2018-2020:\"\n\n\nCode\nprint(data.frame(\n    Neighborhood = top_10_decrease$neighborhood,\n    Change = round(top_10_decrease$change_18_20, 1)\n))\n\n\n        Neighborhood Change\n1          Soundview   -6.6\n2  TriBeCa/Chinatown   -6.6\n3    Lower East Side   -6.6\n4     Morris Heights   -6.4\n5         Mott Haven   -6.4\n6            Belmont   -6.3\n7        Hunts Point   -6.3\n8          Concourse   -6.3\n9   Hamilton Heights   -6.2\n10            Inwood   -6.2\n\n\nCode\nprint(\"\\\nTop 10 largest increases 2020-2022:\")\n\n\n[1] \"\\nTop 10 largest increases 2020-2022:\"\n\n\nCode\nprint(data.frame(\n    Neighborhood = top_10_increase$neighborhood,\n    Change = round(top_10_increase$change_20_22, 1)\n))\n\n\n   Neighborhood Change\n1   High Bridge    7.4\n2    Mott Haven    7.4\n3      Longwood    7.1\n4    West Farms    7.0\n5     Soundview    6.9\n6       Belmont    6.8\n7       Tremont    6.7\n8   Morris Park    6.7\n9     Concourse    6.6\n10   Morrisania    6.5\n\n\nThis is quite remarkable - every single neighborhood showed a decrease in sleep deprivation from 2018 to 2020. The changes ranged from -6.6 to -3.1 percentage points, with a median decrease of 5.2 percentage points. This suggests a universal improvement in sleep patterns across all neighborhoods during this period, possibly related to the changes in work and lifestyle patterns during the early pandemic period.\nThis makes the subsequent increases from 2020 to 2022 that we saw in the previous plots even more notable, as they represent a partial reversal of these universal improvements.\n\n\n3.2.3 Which borough gets the best sleep? - GRAPH 5 MEDIOCRE\n\n\nCode\nlibrary(ggrepel)\n# Borough-level view with neighborhood labels\nsleep_health_data_geo |&gt;\n  group_by(borough) |&gt;\n  summarise(\n    avg_sleep = mean(prc_s22),\n    .groups = \"drop\"\n  ) |&gt;\n  ggplot() +\n  geom_sf(aes(fill = avg_sleep)) +\n  geom_sf_label(aes(label = borough), \n                size = 3,\n                alpha = 0.8) +\n  scale_fill_viridis(\n    option = \"magma\",\n    name = \"Average %\\nSleeping &lt;7hrs\",\n    direction = -1  # Added this line to flip the scale\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Sleep Deprivation by Borough (2022)\",\n    subtitle = \"Average percentage of adults reporting less than 7 hours of sleep\",\n    caption = \"Data source: CDC\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(color = \"gray30\"),\n    legend.position = \"right\",\n    panel.grid = element_blank(),\n    axis.text = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n3.2.4 Which neighborhoods are sleeping the most? - GRAPH 6A\n\n\nCode\n# Neighborhood-level view labeling areas with best sleep\nsleep_health_data_geo |&gt;\n group_by(borough) |&gt;\n # Get bottom 3 neighborhoods per borough (lowest sleep deprivation = best sleep)\n mutate(\n   should_label = rank(prc_s22, ties.method = \"random\") &lt;= 3  # Changed from -prc_s22 to prc_s22 to get lowest values\n ) |&gt;\n ungroup() |&gt;\n ggplot() +\n geom_sf(aes(fill = prc_s22)) +\n geom_label_repel(\n   data = . %&gt;% filter(should_label),\n   aes(\n     label = nghbrhd,\n     geometry = geometry\n   ),\n   stat = \"sf_coordinates\",\n   size = 2.5,\n   alpha = 0.9,\n   box.padding = 0.5,\n   point.padding = 0.2,\n   max.overlaps = 30,\n   force = 10\n ) +\n scale_fill_viridis(\n   option = \"magma\",\n   name = \"Average %\\nSleeping &lt;7hrs\",\n   direction = -1\n ) +\n theme_minimal() +\n labs(\n   title = \"Sleep Deprivation by NYC Neighborhood (2022)\",\n   subtitle = \"Labels shown for three neighborhoods with lowest sleep deprivation per borough\",\n   caption = \"Data source: CDC\"\n ) +\n theme(\n   plot.title = element_text(face = \"bold\", size = 14),\n   plot.subtitle = element_text(color = \"gray30\"),\n   legend.position = \"right\",\n   panel.grid = element_blank(),\n   axis.text = element_blank()\n )\n\n\n\n\n\n\n\n\n\n\n\n3.2.5 Which neighborhoods are sleeping the least? - GRAPH 6B\n\n\nCode\n# Neighborhood-level view with selective repelling labels\nsleep_health_data_geo |&gt;\n  group_by(borough) |&gt;\n  # Get top 3 neighborhoods per borough\n  mutate(\n    should_label = rank(-prc_s22, ties.method = \"random\") &lt;= 3\n  ) |&gt;\n  ungroup() |&gt;\n  ggplot() +\n  geom_sf(aes(fill = prc_s22)) +\n  geom_label_repel(\n    data = . %&gt;% filter(should_label),\n    aes(\n      label = nghbrhd,\n      geometry = geometry\n    ),\n    stat = \"sf_coordinates\",\n    size = 2.5,\n    alpha = 0.9,\n    box.padding = 0.5,\n    point.padding = 0.2,\n    max.overlaps = 30,\n    force = 10\n  ) +\n  scale_fill_viridis(\n    option = \"magma\",\n    name = \"Average %\\nSleeping &lt;7hrs\",\n    direction = -1\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Sleep Deprivation by NYC Neighborhood (2022)\",\n    subtitle = \"Labels shown for three neighborhoods with highest sleep deprivation per borough\",\n    caption = \"Data source: CDC\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(color = \"gray30\"),\n    legend.position = \"right\",\n    panel.grid = element_blank(),\n    axis.text = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nNow that we have a sense of sleep deprivation over time and by neighborhood, let’s explore its relationship with some demographic data..",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#how-do-the-various-racial-and-socioeconomic-demographics-relate-to-sleep-deprivation",
    "href": "results.html#how-do-the-various-racial-and-socioeconomic-demographics-relate-to-sleep-deprivation",
    "title": "3  Results",
    "section": "3.3 How do the various racial and socioeconomic demographics relate to sleep deprivation?",
    "text": "3.3 How do the various racial and socioeconomic demographics relate to sleep deprivation?\n\n3.3.1 Principal Component Analysis Biplot - GRAPH 7\n\n\nCode\ndf &lt;- read.csv(\"data/sleep_health_final_dataset.csv\")\n\n# Create the subset with the same variables as before\nsleep_health_subset &lt;- df |&gt;\n  mutate(\n    perc_white = white / nh_total * 100,\n    perc_black = black / nh_total * 100,\n    perc_asian = asian / nh_total * 100,\n    perc_hispanic = hispanic / total * 100,\n    inc_mean = as.numeric(inc_mean),\n    ins_total = as.numeric(ins_total),\n    perc_ba_plus = edu_min_ba / total_25yo * 100\n  ) |&gt;\n  select(\n    perc_white, perc_black, perc_asian, perc_hispanic,\n    perc_ba_plus, inc_mean, ins_total,\n    perc_sleep18, perc_sleep20, perc_sleep22\n  )\n\n# Remove rows with NA values\nsleep_health_subset_clean &lt;- na.omit(sleep_health_subset)\n\n# Perform PCA\npca_data &lt;- sleep_health_subset_clean |&gt; \n  scale() |&gt; \n  prcomp()\n\n# Calculate variance explained\nvar_explained &lt;- pca_data$sdev^2 / sum(pca_data$sdev^2) * 100\n\n# Extract scores and add ZCTA5\nscores &lt;- as.data.frame(pca_data$x[,1:2])\nscores$zcta5 &lt;- df$zcta5[!is.na(rowSums(sleep_health_subset))]\n\n# Extract loadings\nloadings &lt;- as.data.frame(pca_data$rotation[,1:2])\nloadings$variable &lt;- c(\"White\", \"Black\", \"Asian\", \"Hispanic\",\n                      \"Bachelor's+\", \"Income\", \"Insurance\",\n                      \"Sleep Dep 2018\", \"Sleep Dep 2020\", \"Sleep Dep 2022\")\n\n# Find extreme points\nscores$quadrant &lt;- with(scores, \n                       ifelse(PC1 &gt; 0 & PC2 &gt; 0, 1,\n                       ifelse(PC1 &lt; 0 & PC2 &gt; 0, 2,\n                       ifelse(PC1 &lt; 0 & PC2 &lt; 0, 3, 4))))\n\nextreme_points &lt;- data.frame()\nfor(q in 1:4) {\n    quad_points &lt;- scores[scores$quadrant == q, ]\n    if(nrow(quad_points) &gt; 0) {\n        distances &lt;- sqrt(quad_points$PC1^2 + quad_points$PC2^2)\n        extreme_points &lt;- rbind(extreme_points, \n                              quad_points[which.max(distances), ])\n    }\n}\n\n# Create the biplot\nlibrary(ggplot2)\nlibrary(ggrepel)\n\np &lt;- ggplot() +\n    # Plot all points\n    geom_point(data = scores, \n               aes(x = PC1, y = PC2),\n               color = 'grey70',\n               alpha = 0.5) +\n    # Highlight extreme points\n    geom_point(data = extreme_points,\n               aes(x = PC1, y = PC2),\n               color = \"steelblue\",\n               size = 3) +\n    # Add arrows for variables\n    geom_segment(data = loadings,\n                aes(x = 0, y = 0, \n                    xend = PC1 * 5,\n                    yend = PC2 * 5),\n                arrow = arrow(length = unit(0.2, \"cm\")),\n                color = \"coral\") +\n    # Add variable labels\n    geom_text_repel(data = loadings,\n                    aes(x = PC1 * 5.5,\n                        y = PC2 * 5.5,\n                        label = variable),\n                    color = \"brown\",\n                    size = 3,\n                    max.overlaps = 20) +\n    # Add ZCTA labels for extreme points\n    geom_text_repel(data = extreme_points,\n                    aes(x = PC1, y = PC2, \n                        label = zcta5),\n                    size = 3,\n                    color = \"steelblue\",\n                    box.padding = 0.5) +\n    # Theme and labels\n    theme_classic() +\n    labs(\n        title = \"PCA Biplot of Sleep and Demographic Variables\",\n        x = paste0(\"PC1 (\", round(var_explained[1], 1), \"%)\"),\n        y = paste0(\"PC2 (\", round(var_explained[2], 1), \"%)\")\n    ) +\n    # Add reference lines\n    geom_hline(yintercept = 0, linetype = \"dashed\", alpha = 0.3) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", alpha = 0.3) +\n    # Make the plot square\n    coord_fixed()\n\nprint(p)\n\n\n\n\n\n\n\n\n\nIn case you were curious, those 4 outliers are…\n\n\nCode\ndf |&gt; \n  filter(zcta5 %in% c(11368, 11212, 11360, 10004)) |&gt; \n  select(\"zcta5\", \"neighborhood\", \"borough\", \"nh_total\", \"white\", \"black\",\n         \"asian\", \"hispanic\", \"total\", \"inc_mean\", \"ins_total\", \"edu_min_ba\", \n         \"total_25yo\") |&gt;\n  mutate(\n    perc_white = white / nh_total * 100,\n    perc_black = black / nh_total * 100,\n    perc_asian = asian / nh_total * 100,\n    perc_hispanic = hispanic / total * 100,\n    inc_mean = as.numeric(inc_mean),\n    ins_total = as.numeric(ins_total),\n    perc_ba_plus = edu_min_ba / total_25yo * 100\n  ) |&gt; \n  select(-\"nh_total\", -\"white\", -\"black\",\n         -\"asian\", -\"hispanic\", -\"total\", -\"edu_min_ba\", \n         -\"total_25yo\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nzcta5\nneighborhood\nborough\ninc_mean\nins_total\nperc_white\nperc_black\nperc_asian\nperc_hispanic\nperc_ba_plus\n\n\n\n\n10004\nFinancial District\nManhattan\n232543\n99.7\n59.080460\n5.793103\n31.4942529\n5.001092\n94.47853\n\n\n11212\nBrownsville\nBrooklyn\n35840\n92.7\n4.313952\n87.009358\n0.9742612\n19.480751\n15.74208\n\n\n11360\nBayside\nQueens\n100016\n95.2\n61.253465\n1.334917\n34.3741162\n10.345352\n51.44637\n\n\n11368\nCorona\nQueens\n69391\n76.6\n18.382866\n30.755667\n46.4090224\n75.857206\n13.65266\n\n\n\n\n\n\nHere are the key takeaways from this PCA biplot:\n\nThe first two principal components explain a large portion of variance (PC1: 62.2%, PC2: 16.3%, total: 78.5%)\nSleep deprivation measures across years (2018, 2020, 2022):\n\nShow strong correlation with each other\nHave positive association with Black population percentage\nHave negative association with income, education (Bachelor’s), and White population percentage\nShow moderate negative correlation with insurance coverage\n\nSocioeconomic and demographic relationships:\n\nAsian and Hispanic populations show near orthogonality (little correlation)\nWhite and Black populations show strong negative correlation\nInsurance coverage shows strong positive correlation with income and education levels\nBoth Asian and Hispanic populations show negative associations with insurance coverage\nIncome, education, and insurance coverage cluster together, suggesting strong interrelation\n\nNotable outlier ZIP Code Tabulation Areas (ZCTAs):\n\n11368: Extremely high PC2 score\n11212: Extremely high PC1 score\n10004 and 11360: Extremely low PC1 scores\n\nMethodological note:\n\nArrow orientations (not directions) indicate relationships\nCosine of angle between arrows approximates correlation\nArrow length indicates strength of variable’s contribution to shown components",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#racial-differences-in-sleep-deprivation-alongside-income",
    "href": "results.html#racial-differences-in-sleep-deprivation-alongside-income",
    "title": "3  Results",
    "section": "3.4 Racial Differences in Sleep Deprivation Alongside Income",
    "text": "3.4 Racial Differences in Sleep Deprivation Alongside Income\n\n3.4.1 Percentage Black population at Different Income Levels - GRAPH 8\n\n\nCode\n# Load and prepare the data\ndf &lt;- read.csv(\"data/sleep_health_final_dataset.csv\")\n\n# Calculate percentage black and create income groups\ndf &lt;- transform(df,\n    perc_black = black / nh_total * 100,\n    # Create income groups based on mean income\n    income_group = cut(as.numeric(inc_mean), \n                      breaks = quantile(as.numeric(inc_mean), probs = seq(0, 1, by = 0.25), na.rm = TRUE),\n                      labels = c(\"Low Income\", \"Lower-Middle Income\", \"Upper-Middle Income\", \"High Income\"),\n                      include.lowest = TRUE)\n)\n\n# Create the scatter plot\nlibrary(ggplot2)\n\np &lt;- ggplot(df, aes(x = perc_black, y = perc_sleep18)) +\n    geom_point(alpha = 0.6) +\n    geom_smooth(method = \"lm\", se = TRUE, color = \"red\", alpha = 0.2) +\n    facet_wrap(~income_group) +\n    theme_minimal() +\n    labs(\n        title = \"Sleep Deprivation vs Black Population Percentage by Income Group\",\n        x = \"Black Population (%)\",\n        y = \"Sleep Deprived Population (%)\",\n        caption = \"Income groups based on quartiles of mean income\"\n    ) +\n    theme(\n        plot.title = element_text(size = 11),\n        axis.text = element_text(size = 9),\n        strip.text = element_text(size = 9)\n    )\n\nprint(p)\n\n\n\n\n\n\n\n\n\nMAYBE LABEL THE OUTLIER HERE\n\n\n3.4.2 Percentage White population at Different Income Levels - GRAPH 9\n\n\nCode\n# Load and prepare the data\ndf &lt;- read.csv(\"data/sleep_health_final_dataset.csv\")\n\n# Calculate percentage white and create income groups\ndf &lt;- transform(df,\n    perc_white = white / nh_total * 100,\n    # Create income groups based on mean income\n    income_group = cut(as.numeric(inc_mean), \n                      breaks = quantile(as.numeric(inc_mean), \n                                        probs = seq(0, 1, by = 0.25), \n                                        na.rm = TRUE),\n                      labels = c(\"Low Income\", \"Lower-Middle Income\", \n                                 \"Upper-Middle Income\", \"High Income\"),\n                      include.lowest = TRUE)\n)\n\n\nggplot(df, aes(x = perc_white, y = perc_sleep18)) +\n    geom_point(alpha = 0.6) +\n    geom_smooth(method = \"lm\", se = TRUE, color = \"red\", alpha = 0.2) +\n    facet_wrap(~income_group) +\n    theme_minimal() +\n    labs(\n        title = \"Sleep Deprivation vs White Population Percentage by Income Group\",\n        x = \"White Population (%)\",\n        y = \"Sleep Deprived Population (%)\",\n        caption = \"Income groups based on quartiles of mean income\"\n    ) +\n    theme(\n        plot.title = element_text(size = 11),\n        axis.text = element_text(size = 9),\n        strip.text = element_text(size = 9)\n    )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  }
]